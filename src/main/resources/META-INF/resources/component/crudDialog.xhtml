<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:dbs="http://www.dbsoft.com.br/ui/dbsfaces"
	xmlns:dbscom="http://www.dbsoft.com.br/ui/dbsfacescom">
		
	<cc:interface componentType="br.com.dbsoft.ui.component.crudDialog">
		<cc:attribute name="crudBean" preferred="true" required="true"/>
		<cc:attribute name="id" preferred="true"/>
		<cc:attribute name="style"/>
		<cc:attribute name="styleClass"/>
		<cc:attribute name="rendered" preferred="true"/>	
		<cc:attribute name="update" default=""/>
		<cc:attribute name="allowDelete" default="true"/>
		<cc:attribute name="allowUpdate" default="true"/>
		<cc:attribute name="width" default="100"/>
		<cc:attribute name="height" default="100"/>
		<cc:facet name="approveDialog"/>
		<cc:facet name="reproveDialog"/>
	</cc:interface>
	
	<cc:implementation >
		<div id="#{cc.clientId}" class="dbs_crudDialog #{cc.attrs.styleClass}" style="#{cc.attrs.style}">
			<dbs:div id="content">
				<dbs:dialog id="dialog"
				            caption="#{cc.crudBean.dialogCaption}" 
							width="#{cc.attrs.width}" 
							height="#{cc.attrs.height}">
					<f:facet name="toolbar">
						<c:if test="#{cc.crudBean.isViewing}">
							<dbs:ul style="float:left;">
								<dbs:li>
									<dbs:button id="btFirstx" iconClass="-i_navigate_first" rendered="#{cc.crudBean.isFirst}" styleClass="dbs_button -disabled" style="opacity:0.3;" readOnly="true"/>
									<dbs:button id="btFirst" iconClass="-i_navigate_first" rendered="#{!cc.crudBean.isFirst}" action="#{cc.crudBean.moveFirst()}" update=":dialog " execute="@this"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btPreviousx" iconClass="-i_navigate_previous" rendered="#{cc.crudBean.isFirst}" styleClass="dbs_button -disabled" style="opacity:0.3;" readOnly="true"/>
									<dbs:button id="btPrevious" iconClass="-i_navigate_previous" rendered="#{!cc.crudBean.isFirst}" action="#{cc.crudBean.movePrevious()}" update=":dialog " execute="@this"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btNextx" iconClass="-i_navigate_next" rendered="#{cc.crudBean.isLast}" styleClass="dbs_button -disabled" style="opacity:0.3;" readOnly="true"/>
									<dbs:button id="btNext" iconClass="-i_navigate_next" rendered="#{!cc.crudBean.isLast}" action="#{cc.crudBean.moveNext()}" update=":dialog " execute="@this"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btLastx" iconClass="-i_navigate_last" rendered="#{cc.crudBean.isLast}" styleClass="dbs_button -disabled" style="opacity:0.3;" readOnly="true"/>
									<dbs:button id="btLast" iconClass="-i_navigate_last" rendered="#{!cc.crudBean.isLast}" action="#{cc.crudBean.moveLast()}" update=":dialog " execute="@this"/>
								</dbs:li>
							</dbs:ul>						
							<dbs:ul >
								<dbs:li rendered="#{cc.crudBean.allowCopy or cc.crudBean.allowCopyOnUpdate}">
									<dbs:button id="btCopy" iconClass="-i_copy" action="#{cc.crudBean.copy()}" update=":dialog " execute="@this" tooltip="Copiar dados para memória"/>
								</dbs:li>
								<dbs:li rendered="#{cc.attrs.allowDelete and cc.crudBean.allowDelete}">
									<dbs:button id="btDelete" iconClass="-i_delete" action="#{cc.crudBean.delete()}" update=":dialog " execute="@this" tooltip="Excluir"/>
								</dbs:li>
								<dbs:li rendered="#{cc.attrs.allowUpdate and cc.crudBean.allowUpdate}">
									<dbs:button id="btEdit" iconClass="-i_edit" action="#{cc.crudBean.update()}" update=":dialog" execute="@this" tooltip="Editar"/> 
								</dbs:li>
								<dbs:li>
<!-- Retinado update do cc.clientId								   -->								
<!-- 								<dbs:button id="close" iconClass="-i_cancel" action="#{cc.crudBean.close()}" update=":dialog #{cc.clientId} #{cc.attrs.update}" execute="@this"/> -->
									<dbs:button id="btClose" iconClass="-i_cancel -red" action="#{cc.crudBean.close()}" update=":dialog #{cc.attrs.update}" execute="@this" tooltip="Fechar"/>
								</dbs:li>
							</dbs:ul>
						</c:if>
						<c:if test="#{cc.crudBean.isUpdating}">
							<dbs:ul>
								<dbs:li styleClass="-icon">
									<dbs:img styleClass="-i_edit"/>
								</dbs:li>
								<dbs:li rendered="#{cc.crudBean.allowCopyOnUpdate}">
									<dbs:button id="btPaste" iconClass="-i_paste" action="#{cc.crudBean.paste()}" rendered="#{cc.crudBean.isCopied}" update=":dialog " execute="@this" tooltip="Colar dados em memória"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btOk" iconClass="-i_ok -green" action="#{cc.crudBean.confirmEditing()}" update=":dialog #{cc.attrs.update}" execute="#{cc.clientId}" tooltip="Confirmar"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btCancel" iconClass="-i_cancel -red" action="#{cc.crudBean.ignoreEditing()}" update=":dialog" execute="#{cc.clientId}" tooltip="Ignorar"/>
								</dbs:li>
							</dbs:ul>
						</c:if>
						<c:if test="#{cc.crudBean.isInserting}">
							<dbs:ul>
								<dbs:li styleClass="-icon">
									<dbs:img styleClass="-i_insert"/>
								</dbs:li>
								<dbs:li rendered="#{cc.crudBean.allowCopy}">
									<dbs:button id="btPaste" iconClass="-i_paste" action="#{cc.crudBean.paste()}" rendered="#{cc.crudBean.isCopied}" update=":dialog " execute="@this" tooltip="Colar dados em memória"/>
								</dbs:li>
								<dbs:li>
									<dbs:button id="btOk" iconClass="-i_ok -green" action="#{cc.crudBean.confirmEditing()}" update=":dialog #{cc.attrs.update}" execute="#{cc.clientId}" tooltip="Confirmar"/>
								</dbs:li>
								<dbs:li>
<!-- Retinado update do cc.clientId								   -->
<!-- 									<dbs:button id="cancel" iconClass="-i_cancel" action="#{cc.crudBean.ignoreEditing()}" update=":dialog #{cc.clientId} #{cc.attrs.update}" execute="#{cc.clientId}"/> -->
									<dbs:button id="btCancel" iconClass="-i_cancel -red" action="#{cc.crudBean.ignoreEditing()}" update=":dialog #{cc.attrs.update}" execute="#{cc.clientId}" tooltip="Ignorar"/>
								</dbs:li>
							</dbs:ul>
						</c:if>
						<c:if test="#{cc.crudBean.isDeleting}">
							<dbs:ul>
								<dbs:li styleClass="-icon">
									<dbs:img styleClass="-i_delete"/>
								</dbs:li>
							</dbs:ul>
						</c:if>
					</f:facet>
					
					<cc:insertChildren/>
						
					<f:facet name="dialogMessages">
						<dbscom:beanCrudDialogMessages id="message"
												   crudBean="#{cc.crudBean}"
		 							               update=":dialog #{cc.crudBean.isDeleting ? cc.attrs.update : ''} ">
		 				</dbscom:beanCrudDialogMessages>
					</f:facet>
				</dbs:dialog>
			</dbs:div>
		</div>
	</cc:implementation>
</ui:component>