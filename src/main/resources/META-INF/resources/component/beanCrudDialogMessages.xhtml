<ui:component xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:cc="http://java.sun.com/jsf/composite"
	xmlns:dbs="http://www.dbsoft.com.br/ui/dbsfaces"
	xmlns:dbscom="http://www.dbsoft.com.br/ui/dbsfacescom">
		
	<cc:interface componentType="br.com.dbsoft.ui.component.beanCrudDialogMessages">
		<cc:attribute name="crudBean" preferred="true" required="true"/>
		<cc:attribute name="update"/>
	</cc:interface>
	
	<cc:implementation>
		<!--Artifício para forçar o id para certificar que o clientId já vem completo com os nomes dos parents, já que por motivos desconhecidos isso não ocorre sempre -->
		<f:event listener="#{cc.setId(cc.id)}" type="preRenderComponent"/>
		<div id="#{cc.clientId}">
			<dbscom:beanDialogMessages id="#{cc.id}_info"
								   userBean="#{cc.crudBean}"
						               update="#{cc.attrs.update}">
			</dbscom:beanDialogMessages>
	
			<c:if test="#{!cc.crudBean.hasMessage}">
				<c:if test="#{cc.crudBean.isCommitting}">
					<dbs:dialog id="#{cc.id}_confirm"
								rendered="#{cc.crudBean.isCommitting}"
								messageIcon="c"
								height="150" 
								width="200" 
								noAction="#{cc.crudBean.endEditing(false)}"
								yesAction="#{cc.crudBean.endEditing(true)}"
								update="#{cc.attrs.update}" >
						<ui:fragment rendered="#{cc.crudBean.isUpdating}">
							<h:outputText value="#{cc.crudBean.messageConfirmationEdit}" escape="false"/>
						</ui:fragment>		
						<ui:fragment rendered="#{cc.crudBean.isInserting}">
							<h:outputText value="#{cc.crudBean.messageConfirmationInsert}" escape="false"/>
						</ui:fragment>		
						<ui:fragment rendered="#{cc.crudBean.isDeleting}">
							<h:outputText value="#{cc.crudBean.messageConfirmationDelete}" escape="false"/>
						</ui:fragment>		
					</dbs:dialog>
				</c:if>
				<c:if test="#{cc.crudBean.isIgnoring}">
					<dbs:dialog id="#{cc.id}_ignore" 
								rendered="#{cc.crudBean.isIgnoring}"
								messageIcon="g"
								height="150" 
								width="200" 
								noAction="#{cc.crudBean.endEditing(false)}"
								yesAction="#{cc.crudBean.endEditing(true)}"
								update="#{cc.attrs.update}">
						<ui:fragment rendered="#{cc.crudBean.isUpdating}">
							<h:outputText value="#{cc.crudBean.messageIgnoreEdit}" escape="false"/>
						</ui:fragment>		
						<ui:fragment rendered="#{cc.crudBean.isInserting}">
							<h:outputText value="#{cc.crudBean.messageIgnoreInsert}" escape="false"/>
						</ui:fragment>		
						<ui:fragment rendered="#{cc.crudBean.isDeleting}">
							<h:outputText value="#{cc.crudBean.messageIgnoreDelete}" escape="false"/>
						</ui:fragment>		
					</dbs:dialog>
				</c:if>
			</c:if>		
		</div> 
	</cc:implementation>
</ui:component>